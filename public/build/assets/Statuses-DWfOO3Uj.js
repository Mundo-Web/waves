import{C as x,c as C,R as t,r as s}from"./CreateReactScript-BRBWlRTV.js";import{a as k,S as I}from"./SetSelectValue-DT66DheI.js";import{S as A}from"./StatusesRest-CrmCg-yq.js";import{A as T,S as q}from"./Adminto-Bk5OoDPl.js";import{M as B}from"./Modal-CYscrTZ-.js";import{I as R}from"./InputFormGroup-Bwc1l4v7.js";import{T as F}from"./TextareaFormGroup-CQXxCfbs.js";const g=new A,G=({statuses:i,tables:o})=>{const[v,m]=s.useState(i);s.useRef();const u=s.useRef(),d=s.useRef(),c=s.useRef(),p=s.useRef(),f=s.useRef(),E=s.useRef(),[w,N]=s.useState(!1);s.useState(null);const b=e=>{var l,r,n;e!=null&&e.id?N(!0):N(!1),d.current.value=(e==null?void 0:e.id)||null,I(c.current,(l=e==null?void 0:e.table)==null?void 0:l.id,(r=e==null?void 0:e.table)==null?void 0:r.name),(n=e==null?void 0:e.table)!=null&&n.id?$(c.current).parents(".form-group").hide():$(c.current).parents(".form-group").show(),p.current.value=(e==null?void 0:e.name)||null,f.current.value=(e==null?void 0:e.color)||"#343a40",E.current.value=(e==null?void 0:e.description)||null,$(u.current).modal("show")},y=async e=>{e.preventDefault();const l={id:d.current.value||void 0,table_id:c.current.value,name:p.current.value,color:f.current.value,description:E.current.value},r=await g.save(l);r&&(v.find(n=>n.id==r.id)?m(n=>{const a=n.findIndex(h=>h.id==r.id);return console.log(a),n[a]=r,[...n]}):m(n=>[...n,r]),$(u.current).modal("hide"))},S=async e=>{const{isConfirmed:l}=await q.fire({title:"Estas seguro de eliminar este estado?",text:"No podras revertir esta accion!",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar",cancelButtonText:"Cancelar"});!l||!await g.delete(e)||m(n=>[...n.filter(a=>a.id!=e)])};return t.createElement(t.Fragment,null,t.createElement("div",{className:"container"},t.createElement("div",{className:"text-center"},t.createElement("button",{className:"btn btn-primary mb-4 rounded-pill",onClick:()=>b()},"Nuevo Estado")),t.createElement("div",{className:"row align-items-start justify-content-center"},o.map((e,l)=>t.createElement("div",{key:l,className:"col-md-6"},t.createElement("div",{className:"card"},t.createElement("div",{className:"card-header"},t.createElement("div",{className:"d-flex align-items-center justify-content-between"},t.createElement("h5",{className:"my-0 text-capitalize"},"Estados de ",e.name),t.createElement("button",{className:"btn btn-xs btn-primary rounded-pill",onClick:()=>b({table:e})},"Nuevo estado"))),t.createElement("div",{className:"card-body d-flex align-items-start justify-content-center gap-2",style:{flexWrap:"wrap",minHeight:"200px"}},v.filter(r=>r.table_id===e.id).map((r,n)=>t.createElement("div",{key:n,className:"btn-group dropup col-auto"},t.createElement("span",{type:"button",className:"btn btn-sm btn-white",style:{cursor:"default"}},t.createElement("i",{className:"mdi mdi-circle me-1",style:{color:r.color}}),r.name),t.createElement("button",{type:"button",className:"btn btn-sm btn-white dropdown-toggle","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t.createElement("i",{className:"mdi mdi-dots-vertical"})),t.createElement("div",{className:"dropdown-menu"},t.createElement("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>b(r)},"Editar"),t.createElement("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>S(r.id)},"Eliminar")))))))))),t.createElement(B,{modalRef:u,title:w?"Editar estado":"Agregar estado",onSubmit:y,size:"sm"},t.createElement("div",{className:"row",id:"status-crud-container"},t.createElement("input",{ref:d,type:"hidden"}),t.createElement(R,{eRef:p,label:"Nombre de estado",col:"col-12",required:!0}),t.createElement(k,{eRef:c,label:"Tabla",col:"col-12",dropdownParent:"#status-crud-container",searchAPI:"/api/tables/paginate",searchBy:"name",required:!0}),t.createElement(R,{eRef:f,type:"color",label:"Color",col:"col-12",required:!0}),t.createElement(F,{eRef:E,label:"Descripcion",col:"col-12"}))))};x((i,o)=>{if(!o.can("statuses","root","all","list"))return location.href="/";C(i).render(t.createElement(T,{...o,title:"Gestor de estados"},t.createElement(G,{...o})))});
