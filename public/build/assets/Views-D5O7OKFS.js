var k=Object.defineProperty;var w=(l,s,r)=>s in l?k(l,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[s]=r;var E=(l,s,r)=>(w(l,typeof s!="symbol"?s+"":s,r),r);import{C as g,c as R,R as e,r as n}from"./CreateReactScript-BRBWlRTV.js";import{B as C,A as V}from"./Adminto-BQEdF9zl.js";import{M as j}from"./Modal-CYscrTZ-.js";import{I as F}from"./InputFormGroup-Bwc1l4v7.js";import{T as W}from"./TextareaFormGroup-CQXxCfbs.js";class O extends C{constructor(){super(...arguments);E(this,"path","views")}}const b=new O,S=({tables:l,views:s,statuses:r})=>{const c=n.useRef(),u=n.useRef(),m=n.useRef(),i=n.useRef(),o=n.useRef(),[d,h]=n.useState(null);n.useEffect(()=>{p()},[null]);const v=()=>{m.current.value=null,i.current.value=null,o.current.value=null,$('[name="ck-status"]').prop("checked",!1),$(u.current).modal("show")},p=t=>{var a;h((a=c==null?void 0:c.current)==null?void 0:a.value)},N=async t=>{t.preventDefault();const a={id:m.current.value??void 0,table_id:c.current.value,name:i.current.value,description:o.current.value,statuses:[...$('[name="ck-status"]:checked')].map(y=>y.value)};await b.save(a)&&location.reload()},x=async t=>{await b.delete(t.id)&&location.reload()};return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{minHeight:"calc(100vh - 135px)"}},e.createElement("div",{style:{width:"100%"}},e.createElement("div",{className:"mx-auto form-group",style:{width:"240px"}},e.createElement("div",{className:"form-floating mb-3"},e.createElement("select",{ref:c,className:"form-select",id:"view-select","aria-label":"Crea vistas para",onChange:p},l.map((t,a)=>e.createElement("option",{key:`table-${a}`,value:t.id},t.name))),e.createElement("label",{htmlFor:"view-select"},"Crea vistas para"))),e.createElement("hr",{className:"mx-auto",style:{width:"180px"}}),e.createElement("button",{className:"d-block m-auto btn btn-white rounded-pill mb-3",onClick:v},e.createElement("i",{className:"mdi mdi-plus"})," Nuevo"),e.createElement("div",{className:"d-flex flex-wrap align-items-center justify-content-center gap-3 mb-3",style:{width:"100%"}},s.filter(t=>t.table_id==d).map((t,a)=>e.createElement("div",{key:`service-${a}`,className:"card mb-0",style:{width:"100%",maxWidth:"360px"}},e.createElement("div",{className:"card-body project-box"},e.createElement("div",{className:"float-end"},e.createElement("button",{className:"btn btn-xs btn-white ms-1"},e.createElement("i",{className:"fa fa-pen"})),e.createElement("button",{className:"btn btn-xs btn-danger ms-1",onClick:()=>x(t)},e.createElement("i",{className:"fa fa-trash"}))),e.createElement("h4",{className:"mt-0"},e.createElement("a",{href:`/clients/${t.id}`,className:"text-dark"},t.name," ",e.createElement("i",{className:"mdi mdi-arrow-top-right"}))),e.createElement("div",{className:"mb-2"},e.createElement("code",null,t.id)),e.createElement("p",{className:"text-muted font-13",style:{display:"-webkit-box",WebkitLineClamp:2,textOverflow:"ellipsis",WebkitBoxOrient:"vertical",overflow:"hidden",height:"38px"}},t.description||e.createElement("i",{className:"text-muted"},"- Sin descripcion -")),e.createElement("div",{className:"project-members mb-0"},e.createElement("h5",{className:"mb-1"},"Estados filtrados:"),e.createElement("div",{className:"d-flex flex-wrap gap-2"},e.createElement("p",{key:`status-${a}`,className:"mb-0 font-13",style:{display:"-webkit-box",WebkitLineClamp:2,textOverflow:"ellipsis",WebkitBoxOrient:"vertical",overflow:"hidden",height:"38px"}},t.statuses.length>0?t.statuses.map(({name:f})=>f).join(", "):e.createElement("i",{className:"text-muted"},"No se han seleccionado filtros de estado para esta vista"),"."))))))))),e.createElement(j,{modalRef:u,title:"Agregar vista",size:"sm",onSubmit:N},e.createElement("input",{ref:m,type:"hidden"}),e.createElement(F,{eRef:i,label:"Nombre",required:!0}),e.createElement(W,{eRef:o,label:"Descripcion"}),e.createElement("hr",{className:"my-2"}),e.createElement("h5",null,"Filtro de estados ",e.createElement("small",{className:"text-muted",style:{fontWeight:"normal"}},"Que estados quieres filtrar en esta vista")),e.createElement("div",{className:"d-flex flex-wrap justify-content-center gap-2"},r.filter(t=>t.table.id==d).map((t,a)=>e.createElement("div",{key:`status-${a}`,className:"form-check form-check-success"},e.createElement("input",{className:"form-check-input",type:"checkbox",name:"ck-status",value:t.id,id:`status-${a}`,style:{cursor:"pointer"}}),e.createElement("label",{className:"form-check-label",htmlFor:`status-${a}`,style:{cursor:"pointer"}},t.name))))))};g((l,s)=>{R(l).render(e.createElement(V,{...s,title:"Vistas de usuario"},e.createElement(S,{...s})))});
